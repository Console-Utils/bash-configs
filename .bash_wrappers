#!/usr/bin/env bash

# shellcheck disable=SC2155

# Recreates current repo by removing all files from current directory and cloning repo again.
__git_repo_recreate() {
  local -i SUCCESS=0
  local -i WRONG_INPUT=1

  local bold='\e[1m'
  local reset='\e[0m'

  if [[ ! -d .git ]]
  then
    echo -e "❌ Can't recreate .git repo from remote because $bold'$PWD'$reset doesn't contain .git folder." >&2
    return $WRONG_INPUT
  fi

  local remote="$(git config --get remote.origin.url)"
  if [[ $remote == "" ]]
  then
    echo -e "❌ Can't recreate .git repo from remote because $bold'$PWD'$reset repo hasn't $bold'origin'$reset remote configured." >&2
    return $WRONG_INPUT
  fi

  rm -rf .git
  rm -rf -- * .* &> /dev/null
  git clone "$remote" .

  return $SUCCESS
}
